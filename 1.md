Ниже — минимальная структура сервера и контракты API, достаточные для текущего клиента (комнаты, бронирования, профиль через Telegram WebApp).

### Структура каталогов
```
server/
  package.json
  tsconfig.json
  .env                 # PORT, CORS_ORIGIN, DATABASE_URL и т.п.
  src/
    index.ts           # запуск Express, CORS, маршруты
    config/
      env.ts           # загрузка .env, валидация
    middleware/
      tgAuth.ts        # валидация Telegram initData (опционально)
      error.ts         # обработчик ошибок
    routes/
      health.ts
      rooms.ts
      bookings.ts
      me.ts
    controllers/
      roomsController.ts
      bookingsController.ts
      meController.ts
    services/
      roomsService.ts
      bookingsService.ts
      tgService.ts     # разбор/валидация initDataUnsafe
    db/
      index.ts         # подключение к БД (или in-memory mock)
      schemas.sql      # (если нужен SQL)
```

### Скрипты
```json
{
  "scripts": {
    "dev": "ts-node-dev --respawn src/index.ts",
    "build": "tsc",
    "start": "node dist/index.js"
  },
  "dependencies": {
    "express": "^4",
    "cors": "^2",
    "zod": "^3"
  },
  "devDependencies": {
    "ts-node-dev": "^2",
    "typescript": "^5",
    "@types/express": "^4",
    "@types/cors": "^2"
  }
}
```

### Базовая инициализация (описание)
- `index.ts`: поднимает Express, включает `cors({ origin: CORS_ORIGIN, credentials: true })`, `json()`, регистрирует роуты `/api/health`, `/api/rooms`, `/api/bookings`, `/api/me`, обработчик ошибок.
- `tgAuth.ts`: парсит и при необходимости валидирует `X-Telegram-Init-Data` (или query/headers) от WebApp; кладёт `req.user` с данными TG.
- `db/index.ts`: на старте держит мок-данные (совместимые с полями клиента: id, name, image, capacity, description, isOccupied, currentBooking; bookings с id, roomId, roomName, userId, date, startTime, endTime, status). Позже можно заменить на БД.

### Контракты API
- GET `/api/health`
  - 200: `{ status: "ok" }`
- GET `/api/rooms`
  - 200: `Room[]` (поля как в клиенте: id, name, image, capacity, description, isOccupied, currentBooking?)
- GET `/api/bookings?userId=<string>`
  - 200: `Booking[]` (фильтр по userId)
- POST `/api/bookings`
  - body: `{ roomId, date, startTime, endTime, userId }`
  - 201: `Booking` (созданная запись)
- PATCH `/api/bookings/:id/cancel`
  - 200: `Booking` (со статусом `cancelled`)
- GET `/api/me`
  - читает данные из Telegram WebApp (через `tgAuth.ts`) и возвращает:
  - 200: `{ id: string, name: string, surname: string, email: string, isAdmin: boolean }`

### CORS и порты
- Сервер на `PORT=4000`
- CORS `origin = http://localhost:3000` (Vite)
- Клиент запрашивает `/api/*` либо проксируйте в Vite.

### Прокси (опционально, чтобы не настраивать CORS)
В `client/vite.config.ts`:
```ts
server: {
  port: 3000,
  proxy: {
    '/api': { target: 'http://localhost:4000', changeOrigin: true }
  }
}
```

Этого достаточно, чтобы клиент:
- получал список комнат,
- создавал/отменял бронирования,
- подтягивал профиль через Telegram WebApp.